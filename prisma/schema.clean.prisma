generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model  {
id Int @id @default(autoincrement())
company_id Int?
vin String? @db.VarChar(50)
make String? @db.VarChar(100)
model String? @db.VarChar(100)
year Int?
body_type String? @db.VarChar(100)
engine String? @db.VarChar(100)
transmission String? @db.VarChar(100)
purchase_price Decimal? @db.Decimal(12, 2)
status String? @db.VarChar(30)
created_at DateTime? @db.Timestamptz(6)
 ? @relation(fields: [company_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
 []
@@map("авто_доноры")
}
model  {
id Int @id @default(autoincrement())
company_id Int?
marketplace_id Int?
external_shop_id String? @db.VarChar(200)
settings_json Json?
status String? @db.VarChar(20)
 ? @relation(fields: [marketplace_id], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "аккаунты_компании_на_м_marketplace_id_fkey1")
 ? @relation(fields: [company_id], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "аккаунты_компании_на_мар_company_id_fkey1")
 []
 []
@@map("аккаунты_компании_на_маркетплейса")
}
model  {
id Int @id @default(autoincrement())
company_id Int?
type String? @db.VarChar(20)
category_id Int?
amount Decimal? @db.Decimal(12, 2)
operation_date DateTime? @db.Date
related_deal_id Int?
comment String?
created_by_employee_id Int?
created_at DateTime? @db.Timestamptz(6)
 ? @relation(fields: [category_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
 ? @relation(fields: [company_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
 ? @relation(fields: [created_by_employee_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
 ? @relation(fields: [related_deal_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
@@map("движения_денег")
}
model  {
id Int @id @default(autoincrement())
company_id Int?
counterparty_id Int?
channel_id Int?
external_chat_id String? @db.VarChar(200)
created_at DateTime? @db.Timestamptz(6)
updated_at DateTime? @db.Timestamptz(6)
 ? @relation(fields: [channel_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
 ? @relation(fields: [company_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
 ? @relation(fields: [counterparty_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
 []
@@map("диалоги")
}
model  {
id Int @id @default(autoincrement())
company_id Int?
employee_id Int?
entity_type String? @db.VarChar(30)
entity_id Int?
action String? @db.VarChar(20)
created_at DateTime? @db.Timestamptz(6)
ip_address String? @db.VarChar(50)
before_data Json?
after_data Json?
 ? @relation(fields: [company_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
 ? @relation(fields: [employee_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
@@map("журналы_аудита")
}
model  {
id Int @id @default(autoincrement())
company_id Int?
title String? @db.VarChar(200)
description String?
entity_type String? @db.VarChar(30)
entity_id Int?
assignee_id Int?
creator_id Int?
priority String? @db.VarChar(20)
status String? @db.VarChar(20)
due_date DateTime? @db.Date
created_at DateTime? @db.Timestamptz(6)
is_auto_generated Boolean?
source_event String? @db.VarChar(50)
__assignee_idTo ? @relation("_assignee_idTo", fields: [assignee_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
 ? @relation(fields: [company_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
__creator_idTo ? @relation("_creator_idTo", fields: [creator_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
@@map("задачи")
}
model  {
id Int @id @default(autoincrement())
company_marketplace_account_id Int?
external_order_id String? @db.VarChar(200)
deal_id Int?
status String? @db.VarChar(20)
ordered_at DateTime? @db.Timestamptz(6)
 ? @relation(fields: [company_marketplace_account_id], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "заказы_маркетп_company_marketplace_account__fkey1")
 ? @relation(fields: [deal_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
@@map("заказы_маркетплейсов")
}
model  {
id Int @id @default(autoincrement())
company_id Int?
deal_id Int?
part_id Int?
counterparty_id Int?
created_at DateTime? @db.Timestamptz(6)
source String? @db.VarChar(50)
 ? @relation(fields: [company_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
 ? @relation(fields: [counterparty_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
 ? @relation(fields: [deal_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
 ? @relation(fields: [part_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
@@map("заказы_с_сайта")
}
model  {
id Int @id @default(autoincrement())
company_id Int?
auto_donor_id Int?
name String? @db.VarChar(200)
oem_number String? @db.VarChar(100)
internal_sku String? @db.VarChar(100)
condition String? @db.VarChar(20)
current_price Decimal? @db.Decimal(12, 2)
temp_price Decimal? @db.Decimal(12, 2)
allocated_cost Decimal? @db.Decimal(12, 2)
status String? @db.VarChar(30)
liquidity_color String? @db.VarChar(10)
storage_days Int?
created_at DateTime? @db.Timestamptz(6)
 []
 ? @relation(fields: [auto_donor_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
 ? @relation(fields: [company_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
 []
 []
 []
 []
@@map("запчасти")
}
model  {
id Int @id @default(autoincrement())
company_id Int?
counterparty_id Int?
employee_id Int?
deal_id Int?
ats_call_id String? @db.VarChar(200)
started_at DateTime? @db.Timestamptz(6)
duration_sec Int?
is_missed Boolean?
record_url String?
 ? @relation(fields: [company_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
 ? @relation(fields: [counterparty_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
 ? @relation(fields: [deal_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
 ? @relation(fields: [employee_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
@@map("звонки")
}
model  {
id Int @id @default(autoincrement())
code String? @db.VarChar(50)
name String? @db.VarChar(100)
 []
@@map("каналы_коммуникации")
}
model  {
id Int @id @default(autoincrement())
company_id Int?
name String? @db.VarChar(150)
type String? @db.VarChar(20)
 []
 ? @relation(fields: [company_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
@@map("категории_движения_денег")
}
model  {
id Int @id @default(autoincrement())
name String? @db.VarChar(200)
legal_name String? @db.VarChar(300)
phone String? @db.VarChar(50)
email String? @db.VarChar(150)
specialization String? @db.VarChar(20)
logo_url String?
requisites_json Json?
disk_quota_mb Int?
disk_used_mb Int?
status String? @db.VarChar(20)
created_at DateTime? @db.Timestamptz(6)
 []
 []
 []
 []
 []
 []
 []
 []
 []
 []
 []
 []
 []
 []
 []
 []
 []
 []
 []
@@map("компании")
}
model  {
id Int @id @default(autoincrement())
company_id Int?
name String? @db.VarChar(200)
phone String? @db.VarChar(50)
email String? @db.VarChar(150)
type String? @db.VarChar(30)
delivery_preferences String?
comment String?
created_at DateTime? @db.Timestamptz(6)
 []
 []
 []
 ? @relation(fields: [company_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
 []
@@map("контрагенты")
}
model  {
id Int @id @default(autoincrement())
code String? @db.VarChar(50)
name String? @db.VarChar(100)
 []
@@map("маркетплейсы")
}
model  {
id Int @id @default(autoincrement())
company_id Int?
url String?
type String? @db.VarChar(20)
file_size Int?
owner_type String? @db.VarChar(30)
owner_id Int?
created_at DateTime? @db.Timestamptz(6)
 ? @relation(fields: [company_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
 []
@@map("медиа_файлы")
}
model  {
id Int @id @default(autoincrement())
company_id Int?
parent_id Int?
type String? @db.VarChar(20)
code String? @db.VarChar(100)
qr_code_value String? @db.VarChar(200)
barcode_value String? @db.VarChar(200)
description String?
 ? @relation(fields: [company_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
 ? @relation("To", fields: [parent_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
other_ [] @relation("To")
 []
@@map("места_хранения")
}
model  {
id Int @id @default(autoincrement())
part_id Int?
location_id Int?
status String? @db.VarChar(20)
quantity Int?
created_at DateTime? @db.Timestamptz(6)
moved_at DateTime? @db.Timestamptz(6)
 ? @relation(fields: [location_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
 ? @relation(fields: [part_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
@@map("остатки_запчастей")
}
model  {
id Int @id @default(autoincrement())
company_id Int?
deal_id Int?
provider String? @db.VarChar(50)
amount Decimal? @db.Decimal(12, 2)
currency String? @db.VarChar(10)
paid_at DateTime? @db.Timestamptz(6)
status String? @db.VarChar(20)
provider_payment_id String? @db.VarChar(200)
created_at DateTime? @db.Timestamptz(6)
 ? @relation(fields: [company_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
 ? @relation(fields: [deal_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
 []
@@map("платежи")
}
model  {
id Int @id @default(autoincrement())
company_id Int?
tariff_plan_id Int?
start_at DateTime? @db.Timestamptz(6)
end_at DateTime? @db.Timestamptz(6)
status String? @db.VarChar(20)
own_sales_team Boolean?
sales_team_model String? @db.VarChar(30)
created_at DateTime? @db.Timestamptz(6)
 ? @relation(fields: [company_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
 ? @relation(fields: [tariff_plan_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
@@map("подписки_компаний")
}
model  {
id Int @id @default(autoincrement())
deal_id Int?
part_id Int?
quantity Int?
price Decimal? @db.Decimal(12, 2)
cost Decimal? @db.Decimal(12, 2)
reserved_from DateTime? @db.Timestamptz(6)
reserved_until DateTime? @db.Timestamptz(6)
reservation_status String? @db.VarChar(20)
 ? @relation(fields: [deal_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
 ? @relation(fields: [part_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
@@map("позиции_сделки")
}
model  {
id Int @id @default(autoincrement())
role_id Int?
permission_code String? @db.VarChar(100)
 ? @relation(fields: [role_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
@@map("права_ролей")
}
model  {
id Int @id @default(autoincrement())
company_id Int?
name String? @db.VarChar(100)
is_system_default Boolean?
 []
 ? @relation(fields: [company_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
 []
@@map("роли")
}
/// This model or at least one of its fields has comments in the database, and requires an additional setup for migrations: Read more: https://pris.ly/d/database-comments
model  {
employee_id Int
role_id Int
  @relation(fields: [employee_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  @relation(fields: [role_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
@@id([employee_id, role_id])
@@map("роли_сотрудников")
}
model  {
id Int @id @default(autoincrement())
company_id Int?
subdomain String? @db.VarChar(150)
theme String? @db.VarChar(20)
is_active Boolean?
settings_json Json?
 ? @relation(fields: [company_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
@@map("сайты_компаний")
}
model  {
id Int @id @default(autoincrement())
company_id Int?
counterparty_id Int?
responsible_employee_id Int?
stage String? @db.VarChar(30)
total_amount Decimal? @db.Decimal(12, 2)
total_cost Decimal? @db.Decimal(12, 2)
profit Decimal? @db.Decimal(12, 2)
source String? @db.VarChar(50)
created_at DateTime? @db.Timestamptz(6)
closed_at DateTime? @db.Timestamptz(6)
 []
 []
 []
 []
 []
 []
 ? @relation(fields: [company_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
 ? @relation(fields: [counterparty_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
 ? @relation(fields: [responsible_employee_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
@@map("сделки")
}
model  {
id Int @id @default(autoincrement())
conversation_id Int?
sender_type String? @db.VarChar(30)
employee_id Int?
text String?
attachments_json Json?
sent_at DateTime? @db.Timestamptz(6)
 ? @relation(fields: [conversation_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
 ? @relation(fields: [employee_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
@@map("сообщения")
}
model  {
id Int @id @default(autoincrement())
company_id Int?
full_name String? @db.VarChar(200)
phone String? @db.VarChar(50)
email String? @db.VarChar(150)
position String? @db.VarChar(100)
pin_code_hash String? @db.VarChar(255)
is_active Boolean?
created_at DateTime? @db.Timestamptz(6)
last_login_at DateTime? @db.Timestamptz(6)
pin_updated_at DateTime? @db.Timestamptz(6)
pin_failed_attempts Int @default(0)
pin_locked_until DateTime? @db.Timestamptz(6)
 []
 []
__assignee_idTo [] @relation("_assignee_idTo")
__creator_idTo [] @relation("_creator_idTo")
 []
 []
 []
 []
 ? @relation(fields: [company_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
@@map("сотрудники")
}
model  {
id Int @id @default(autoincrement())
code String? @db.VarChar(50)
name String? @db.VarChar(100)
price_month Decimal? @db.Decimal(12, 2)
description String?
settings_json Json?
created_at DateTime? @db.Timestamptz(6)
updated_at DateTime? @db.Timestamptz(6)
 []
@@map("тарифные_планы")
}
model  {
id Int @id @default(autoincrement())
company_marketplace_account_id Int?
part_id Int?
external_product_id String? @db.VarChar(200)
listing_url String?
status String? @db.VarChar(20)
 ? @relation(fields: [company_marketplace_account_id], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "товары_на_марке_company_marketplace_account__fkey")
 ? @relation(fields: [part_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
@@map("товары_на_маркетплейсах")
}
model  {
id Int @id @default(autoincrement())
part_id Int?
media_file_id Int?
is_main Boolean?
has_defect_mark Boolean?
has_watermark Boolean?
background_removed Boolean?
 ? @relation(fields: [media_file_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
 ? @relation(fields: [part_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
@@map("фото_запчастей")
}
model  {
id Int @id @default(autoincrement())
payment_id Int?
atol_receipt_id String? @db.VarChar(200)
receipt_url String?
sent_to String? @db.VarChar(150)
sent_via String? @db.VarChar(20)
created_at DateTime? @db.Timestamptz(6)
 ? @relation(fields: [payment_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
@@map("чеки")
}
